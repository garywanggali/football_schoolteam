{% extends 'base.html' %}

{% block title %}后台管理 - 校园足球队{% endblock %}

{% block content %}
<div class="page-header">
    <div class="container">
        <h1>后台管理系统</h1>
        <p>数据录入与维护</p>
        <div class="mt-3">
            <a href="{{ url_for('logout') }}" class="btn btn-outline-light btn-sm rounded-pill px-3">
                <i class="bi bi-box-arrow-right me-1"></i> 退出登录
            </a>
        </div>
    </div>
</div>

<div class="container py-4">
    <div class="row g-4">
        <!-- 左侧：录入表单 -->
        <div class="col-lg-5">
            <div class="d-grid gap-4">
                
                <!-- 添加球员 -->
                <div class="card shadow-sm">
                    <div class="card-header bg-white py-3">
                        <h5 class="card-title mb-0 fw-bold border-start border-4 border-warning ps-2">添加球员</h5>
                    </div>
                    <div class="card-body">
                        <form method="post">
                            <input type="hidden" name="form_type" value="add_player">
                            <div class="row g-3">
                                <div class="col-6">
                                    <label class="form-label">名字</label>
                                    <input type="text" name="name" class="form-control" required>
                                </div>
                                <div class="col-3">
                                    <label class="form-label">号码</label>
                                    <input type="number" name="number" class="form-control" required>
                                </div>
                                <div class="col-3">
                                    <label class="form-label">年龄</label>
                                    <input type="number" name="age" class="form-control" required>
                                </div>
                                <div class="col-12">
                                    <button type="submit" class="btn btn-primary w-100">添加球员</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- 添加战绩 -->
                <div class="card shadow-sm">
                    <div class="card-header bg-white py-3">
                        <h5 class="card-title mb-0 fw-bold border-start border-4 border-warning ps-2">添加最近战绩</h5>
                    </div>
                    <div class="card-body">
                        <form method="post">
                            <input type="hidden" name="form_type" value="add_result">
                            <div class="row g-3">
                                <div class="col-6">
                                    <label class="form-label">比赛时间</label>
                                    <input type="date" name="match_date" class="form-control" required>
                                </div>
                                <div class="col-6">
                                    <label class="form-label">比赛地点</label>
                                    <input type="text" name="location" class="form-control" required>
                                </div>
                                <div class="col-12">
                                    <label class="form-label">对手</label>
                                    <input type="text" name="opponent" class="form-control" required>
                                </div>
                                <div class="col-6">
                                    <label class="form-label">我队得分</label>
                                    <input type="number" name="our_score" class="form-control" required>
                                </div>
                                <div class="col-6">
                                    <label class="form-label">对手得分</label>
                                    <input type="number" name="opponent_score" class="form-control" required>
                                </div>
                                <div class="col-12">
                                    <button type="submit" class="btn btn-primary w-100">添加战绩</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- 添加统计 -->
                <div class="card shadow-sm">
                    <div class="card-header bg-white py-3">
                        <h5 class="card-title mb-0 fw-bold border-start border-4 border-warning ps-2">添加球员统计</h5>
                    </div>
                    <div class="card-body">
                        <form method="post">
                            <input type="hidden" name="form_type" value="add_stats">
                            <div class="row g-3">
                                <div class="col-6">
                                    <label class="form-label">球员编号</label>
                                    <input type="number" name="player_id" class="form-control" required>
                                </div>
                                <div class="col-6">
                                    <label class="form-label">比赛日期</label>
                                    <input type="date" name="match_date" class="form-control" required>
                                </div>
                                <div class="col-6">
                                    <label class="form-label">类型</label>
                                    <select name="stat_type" class="form-select" required>
                                        <option value="goal">进球</option>
                                        <option value="assist">助攻</option>
                                        <option value="yellow">黄牌</option>
                                        <option value="red">红牌</option>
                                    </select>
                                </div>
                                <div class="col-6">
                                    <label class="form-label">数量</label>
                                    <input type="number" name="value" min="1" class="form-control" required>
                                </div>
                                <div class="col-12">
                                    <button type="submit" class="btn btn-primary w-100">添加数据</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                 <!-- 添加测试场次 -->
                 <div class="card shadow-sm">
                    <div class="card-header bg-white py-3">
                        <h5 class="card-title mb-0 fw-bold border-start border-4 border-warning ps-2">添加测试场次</h5>
                    </div>
                    <div class="card-body">
                        <form method="post">
                            <input type="hidden" name="form_type" value="add_test">
                            <div class="input-group">
                                <input type="date" name="test_date" class="form-control" required>
                                <button type="submit" class="btn btn-primary">添加场次</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- 添加技能数据 -->
                <div class="card shadow-sm">
                    <div class="card-header bg-white py-3">
                        <h5 class="card-title mb-0 fw-bold border-start border-4 border-warning ps-2">添加技能数据</h5>
                    </div>
                    <div class="card-body">
                        <form method="post">
                            <input type="hidden" name="form_type" value="add_skill">
                            <div class="row g-3">
                                <div class="col-6">
                                    <label class="form-label">球员ID</label>
                                    <input type="number" name="player_id" class="form-control" required>
                                </div>
                                <div class="col-6">
                                    <label class="form-label">测试ID</label>
                                    <input type="number" name="test_id" class="form-control" required>
                                </div>
                                <div class="col-6">
                                    <label class="form-label">速度</label>
                                    <input type="number" step="0.01" name="speed" class="form-control" required>
                                </div>
                                <div class="col-6">
                                    <label class="form-label">防守%</label>
                                    <input type="number" name="defense" class="form-control" required>
                                </div>
                                <div class="col-6">
                                    <label class="form-label">绕桩(s)</label>
                                    <input type="number" step="0.01" name="dribble" class="form-control" required>
                                </div>
                                <div class="col-6">
                                    <label class="form-label">短传%</label>
                                    <input type="number" name="pass_short" class="form-control" required>
                                </div>
                                <div class="col-6">
                                    <label class="form-label">长传%</label>
                                    <input type="number" name="pass_long" class="form-control" required>
                                </div>
                                <div class="col-6">
                                    <label class="form-label">射门%</label>
                                    <input type="number" name="shooting" class="form-control" required>
                                </div>
                                <div class="col-12">
                                    <button type="submit" class="btn btn-primary w-100">添加技能数据</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

            </div>
        </div>

        <!-- 右侧：数据列表 -->
        <div class="col-lg-7">
            <div class="d-grid gap-4">
                
                <!-- 球员列表 -->
                <div class="card shadow-sm">
                    <div class="card-header bg-white py-3">
                        <h5 class="card-title mb-0 fw-bold border-start border-4 border-primary ps-2">球员列表</h5>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th>ID</th>
                                        <th>号码</th>
                                        <th>名字</th>
                                        <th>年龄</th>
                                        <th>进球</th>
                                        <th class="text-end pe-4">操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for player in players %}
                                    <tr>
                                        <td>{{ player['id'] }}</td>
                                        <td><span class="badge bg-secondary rounded-pill">{{ player['number'] }}</span></td>
                                        <td class="fw-bold">{{ player['name'] }}</td>
                                        <td>{{ player['age'] }}</td>
                                        <td>{{ player['goals'] }}</td>
                                        <td class="text-end pe-4">
                                            <a href="{{ url_for('delete_player', player_id=player['id']) }}" class="btn btn-sm btn-outline-danger" onclick="return confirm('确定删除吗？')">
                                                <i class="bi bi-trash"></i> 删除
                                            </a>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- 战绩列表 -->
                <div class="card shadow-sm">
                    <div class="card-header bg-white py-3">
                        <h5 class="card-title mb-0 fw-bold border-start border-4 border-primary ps-2">战绩列表</h5>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th>日期</th>
                                        <th>对手</th>
                                        <th>比分</th>
                                        <th class="text-end pe-4">操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for result in results %}
                                    <tr>
                                        <td>{{ result['match_date'] }}</td>
                                        <td>{{ result['opponent'] }}</td>
                                        <td><span class="badge bg-primary">{{ result['our_score'] }} : {{ result['opponent_score'] }}</span></td>
                                        <td class="text-end pe-4">
                                            <a href="{{ url_for('delete_result', result_id=result['id']) }}" class="btn btn-sm btn-outline-danger" onclick="return confirm('确定删除吗？')">
                                                <i class="bi bi-trash"></i> 删除
                                            </a>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
{% endblock %}
